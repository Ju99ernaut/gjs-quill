/*! gjs-quill - 1.0.1 */
!function(t,e){'object'==typeof exports&&'object'==typeof module?module.exports=e():'function'==typeof define&&define.amd?define([],e):'object'==typeof exports?exports["gjs-quill"]=e():t["gjs-quill"]=e()}('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:this,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(t,'__esModule',{value:!0})}},e={};function n(t){if(Array.isArray(t))return t}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t,e){return n(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],l=!0,u=!1;try{for(n=n.call(t);!(l=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);l=!0);}catch(t){u=!0,o=t}finally{try{l||null==n["return"]||n["return"]()}finally{if(u)throw o}}return i}}(t,e)||o(t,e)||i()}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function b(t,e){if(e&&("object"===y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return s(t)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function v(t){return n(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||i()}function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return b(this,n)}}t.r(e),t.d(e,{default:()=>w});const m=function(t){t.on('load',(function(){var e=t.Canvas.getWindow(),n=e.Quill.import('modules/clipboard'),r=e.Quill.import('blots/text'),o=e.Quill.import('delta');function i(t){return t.replace(/[&<>"']/g,(function(t){return{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[t]}))}function u(t){var n=t.quill,r=t.range,i=n.getLines(r),l={};if(i.length>1){var u=i[0].formats(),c=i[i.length-1].formats();l=o.AttributeMap.diff(c,u)|{}}n.deleteText(r,e.Quill.sources.USER),Object.keys(l).length>0&&n.formatLine(r.index,1,l,e.Quill.sources.USER),n.setSelection(r.index,e.Quill.sources.SILENT)}function a(t){var e='ordered'===t?'ol':'ul';switch(t){case'checked':return[e,' data-list="checked"'];case'unchecked':return[e,' data-list="unchecked"'];default:return[e,'']}}function p(t,e,n){if(0===t.length){var r=l(a(n.pop()),1)[0];return e<=0?"</li></".concat(r,">"):"</li></".concat(r,">").concat(p([],e-1,n))}var o=v(t),i=o[0],u=i.child,c=i.offset,f=i.length,s=i.indent,d=i.type,b=o.slice(1),h=l(a(d),2),g=h[0],m=h[1];if(s>e)return n.push(d),s===e+1?"<".concat(g,"><li").concat(m,">").concat(y(u,c,f)).concat(p(b,s,n)):"<".concat(g,"><li>").concat(p(t,e+1,n));var O=n[n.length-1];if(s===e&&d===O)return"</li><li".concat(m,">").concat(y(u,c,f)).concat(p(b,s,n));var j=l(a(n.pop()),1)[0];return"</li></".concat(j,">").concat(p(t,e-1,n))}function y(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if('function'==typeof t.html)return t.html(e,n);if(t instanceof r)return i(t.value().slice(e,e+n));if(t.children){if('list-container'===t.statics.blotName){var u=[];return t.children.forEachAt(e,n,(function(t,e,n){var r=t.formats();u.push({child:t,offset:e,length:n,indent:r.indent||0,type:r.list})})),p(u,-1,[])}var c=[];if(t.children.forEachAt(e,n,(function(t,e,n){c.push(y(t,e,n))})),o||'list'===t.statics.blotName)return c.join('');var a=t.domNode,f=a.outerHTML,s=a.innerHTML,d=f.split(">".concat(s,"<")),b=l(d,2),h=b[0],v=b[1];return'<table'===h?"<table style=\"border: 1px solid #000;\">".concat(c.join(''),"<").concat(v):"".concat(h,">").concat(c.join(''),"<").concat(v)}return t.domNode.outerHTML}var b=function(t){d(r,t);var n=g(r);function r(t,e){var o;return c(this,r),(o=n.call(this,t,e)).quill.root.addEventListener('copy',(function(t){return o.onCaptureCopy(t,!1)})),o.quill.root.addEventListener('cut',(function(t){return o.onCaptureCopy(t,!0)})),o.quill.root.removeEventListener('paste',o.onPaste.bind(s(o))),o.quill.root.addEventListener('paste',o.onCapturePaste.bind(s(o))),o}return f(r,[{key:"onCaptureCopy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t.defaultPrevented){t.preventDefault();var n=this.quill.selection.getRange(),r=l(n,1),o=r[0];if(null!=o){var i=this.onCopy(o),c=i.html,a=i.text;t.clipboardData.setData('text/plain',a),t.clipboardData.setData('text/html',c),e&&u({range:o,quill:this.quill})}}}},{key:"onCapturePaste",value:function(t){if(!t.defaultPrevented&&this.quill.isEnabled()){t.preventDefault();var e=this.quill.getSelection(!0);if(null!=e){var n=t.clipboardData.getData('text/html'),r=t.clipboardData.getData('text/plain'),o=Array.from(t.clipboardData.files||[]);if(!n&&o.length>0)this.quill.uploader.upload(e,o);else{if(n&&o.length>0){var i=(new DOMParser).parseFromString(n,'text/html');if(1===i.body.childElementCount&&'IMG'===i.body.firstElementChild.tagName)return void this.quill.uploader.upload(e,o)}this.onGjsPaste(e,{html:n,text:r})}}}}},{key:"onCopy",value:function(t){var e=this.quill.getText(t);return{html:this.getHTML(t.index,t.length),text:e}}},{key:"getHTML",value:function(t,e){var n=l(this.quill.editor.scroll.line(t),2),r=n[0],o=n[1];return r.length()>=o+e?y(r,o,e,!0):y(this.quill.editor.scroll,o,e,!0)}},{key:"onGjsPaste",value:function(t,n){n.text;var r=n.html,i=this.convert(r),l=(new o).retain(t.index).delete(t.length).concat(i);this.quill.updateContents(l,e.Quill.sources.USER),this.quill.setSelection(l.length()-t.length,e.Quill.sources.SILENT),this.quill.scrollIntoView()}}]),r}(n);e.Quill.register('modules/clipboard',b,!0)}))};function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const w=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=j(j({},{quillOpts:{},clipboard:!0}),e);n.clipboard&&m(t,n),t.setCustomRte({enable:function(e,r){r&&!r.destroyed&&r.destroy(e);var o=t.RichTextEditor.getToolbarEl();[].forEach.call(o.children,(function(t){t.style.display='none'}));var i=t.Canvas.getWindow();return(r=new i.Quill(e,j({theme:'bubble',scrollContainer:'div[data-gjs-type=wrapper]'},n.quillOpts))).getContent=function(){return"<div class=\"ql-editor\">".concat(r.root.innerHTML,"</div>")},r.destroy=function(t){for(var e=0,n=Object.entries(this);e<n.length;e++){delete this[l(n[e],1)[0]]}r.destroyed=!0},this.focus(e,r),r},disable:function(t,e){e&&e.blur()},focus:function(t,e){e&&e.hasFocus()||e&&e.focus()}})};return e})()));
//# sourceMappingURL=index.js.map